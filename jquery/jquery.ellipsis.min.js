/**
* Ellipsis plugin (jQuery) - For when text is too l ...
*
* @fileOverview  A slightly smarter way of truncating text
* @author        Dan Beam <dan@danbeam.org>
* @param         {object} conf - configuration objects to override the defaults
* @return        {jQuery} an instance of jQuery with the original nodes
*
* Copyright (c) 2010 Dan Beam
* Licensed under the MIT License: http://www.opensource.org/licenses/mit-license.php
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
* THE SOFTWARE.
*/
;(function(e){var c=0.01,f=function(i,h){return Math.abs(i-h)<=c;},a=function(i,h){return i-h>=c;},d=function(i,h){return i-h<=c;},g="ellipsis-original-text",b=false;e.fn.ellipsis=function(i){i=e.extend({ellipsis:"\u2026",fudge:0,lines:1,remember:true,"native":true},i||{});if(b&&i["native"]&&i.lines==1&&i.ellipsis==="\u2026"){var h={"white-space":"nowrap",overflow:"hidden"};h[b]="ellipsis";return this.each(function(){e(this).css(h);});}else{return this.each(function(){var r=e(this),l=i.remember&&r.data(g)||r.text(),m=l.length,k=m,p=e(document.createElement(r[0].nodeName)),q,n,j,o;p.css({overflow:"hidden",position:"absolute",visibility:"hidden",bottom:"-10px",right:"-10px",display:"block",width:r.css("width"),fontSize:r.css("font-size"),fontFamily:r.css("font-family"),fontWeight:r.css("font-weight"),letterSpacing:r.css("letter-spacing"),});p.text("s");e("body").append(p);q=p.height();p.css("overflow","visible");n=i.lines*q;p.text(l);j=p.height();if((d(j,n)||f(j,n))&&l.length===r.text().length){p.remove();return;}for(;k>=1;){k=Math.floor(k/2);m+=a(j,n)?-k:+k;p.text(l.slice(0,m-i.ellipsis.length)+i.ellipsis);j=p.height();if(d(j,n)||f(j,n)){o=m;}}p.remove();if(i.remember&&!r.data(g)){r.data(g,l);}if(l.length===(p.text().length-i.ellipsis.length)){r.text(l);}else{if("undefined"!==typeof o){r.text(l.slice(0,o-i.ellipsis.length-i.fudge)+i.ellipsis);}}});}};e(function(){var j=e('<div style="visibility:hidden;position:absolute;white-space:nowrap;overflow:hidden;"></div>'),i=["textOverflow","OTextOverflow"];e(i).each(function(k,l){j.css(l,"ellipsis");});e("body").append(j);var h=j.clone(true);e(i).each(function(k,l){if("ellipsis"===e(h).css(l)){b=l;return false;}});e.fn.ellipsis.nativeSupport=!!b;j.remove();h=j=null;});})(jQuery);