/**
* Ellipsis plugin (jQuery) - For when text is too l ...
*
* @fileOverview  A slightly smarter way of truncating text
* @author        Dan Beam <dan@danbeam.org>
* @param         {object} conf - configuration objects to override the defaults
* @return        {jQuery} an instance of jQuery with the original nodes
*
* Copyright (c) 2010 Dan Beam
* Licensed under the MIT License: http://www.opensource.org/licenses/mit-license.php
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
* THE SOFTWARE.
*/
;(function(d){var b=0.01,e=function(g,f){return Math.abs(g-f)<=b;},a=function(g,f){return g-f>=b;},c=function(g,f){return g-f<=b;};d.fn.ellipsis=function(f){f=d.extend({ellipsis:" ...",fudge:1,lines:1},f||{});return this.each(function(){var o=d(this),i=o.attr("originalText")||o.text(),j=i.length,h=j,m=d(document.createElement(o[0].nodeName)),n,k,g,l;m.css({overflow:"hidden",position:"absolute",visibility:"hidden",bottom:"-10px",right:"-10px",display:"block",width:o.css("width"),fontSize:o.css("font-size"),fontFamily:o.css("font-family"),fontWeight:o.css("font-weight"),letterSpacing:o.css("letter-spacing"),});m.text("some sample text");d("body").append(m);n=m.height();m.css("overflow","visible");k=f.lines*n;m.text(i);g=m.height();if((c(g,k)||e(g,k))&&i.length===o.text().length){m.remove();return;}for(;h>=1;){h=Math.floor(h/2);j+=a(g,k)?-h:+h;m.text(i.slice(0,j-f.ellipsis.length)+f.ellipsis);g=m.height();if(c(g,k)||e(g,k)){l=j;}}m.remove();if(!o.attr("originalText")){o.attr("originalText",i);}if(i.length===(m.text().length-f.ellipsis.length)){o.text(i);}else{if("undefined"!==typeof l){o.text(i.slice(0,l-f.ellipsis.length-f.fudge)+f.ellipsis);}}});};})(jQuery);