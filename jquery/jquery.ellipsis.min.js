/**
* Ellipsis plugin (jQuery) - For when text is too l ...
*
* @fileOverview  A slightly smarter way of truncating text
* @author        Dan Beam <dan@danbeam.org>
* @param         {object} conf - configuration objects to override the defaults
* @return        {jQuery} an instance of jQuery with the original nodes
*
* Copyright (c) 2010 Dan Beam
* Licensed under the MIT License: http://www.opensource.org/licenses/mit-license.php
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
* THE SOFTWARE.
*/
;(function(d){var b=0.01,e=function(g,f){return Math.abs(g-f)<=b;},a=function(g,f){return g-f>=b;},c=function(g,f){return g-f<=b;};d.fn.ellipsis=function(f){f=d.extend({ellipsis:" ...",fudge:3,lines:1,remember:true},f||{});return this.each(function(){var p=d(this),g="ellipsis-original-text",j=f.remember&&p.data(g)||p.text(),k=j.length,i=k,n=d(document.createElement(p[0].nodeName)),o,l,h,m;n.css({overflow:"hidden",position:"absolute",visibility:"hidden",bottom:"-10px",right:"-10px",display:"block",width:p.css("width"),fontSize:p.css("font-size"),fontFamily:p.css("font-family"),fontWeight:p.css("font-weight"),letterSpacing:p.css("letter-spacing"),});n.text("some sample text");d("body").append(n);o=n.height();n.css("overflow","visible");l=f.lines*o;n.text(j);h=n.height();if((c(h,l)||e(h,l))&&j.length===p.text().length){n.remove();return;}for(;i>=1;){i=Math.floor(i/2);k+=a(h,l)?-i:+i;n.text(j.slice(0,k-f.ellipsis.length)+f.ellipsis);h=n.height();if(c(h,l)||e(h,l)){m=k;}}n.remove();if(f.remember&&!p.data(g)){p.data(g,j);}if(j.length===(n.text().length-f.ellipsis.length)){p.text(j);}else{if("undefined"!==typeof m){p.text(j.slice(0,m-f.ellipsis.length-f.fudge)+f.ellipsis);}}});};})(jQuery);