/**
* Ellipsis plugin (YUI) - For when text is too l ...
*
* @fileOverview  A slightly smarter way of truncating text
* @author        Dan Beam <dan@danbeam.org>
* @param         {object} conf - configuration objects to override the defaults
* @return        {Node} the Node passed to the method
*
* Copyright (c) 2010 Dan Beam
* Licensed under the MIT License: http://www.opensource.org/licenses/mit-license.php
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
* THE SOFTWARE.
*/

YUI().add("ellipsis",function(a){a.DOM.ellipsis=function(c,i){i=a.mix(i||{},{ellipsis:" ...",fudge:0,lines:1});var h=a.one(c),g=i.lines*parseInt(h.getComputedStyle("lineHeight")),e=h.getAttribute("originalText")||h.get("text"),f=e.length,d=f,k=a.one(document.createElement(h.get("nodeName"))),b;k.setStyles({position:"absolute",visibility:"hidden",bottom:"-10px",right:"-10px",width:h.getComputedStyle("width"),fontSize:h.getComputedStyle("fontSize"),fontFamily:h.getComputedStyle("fontFamily"),fontWeight:h.getComputedStyle("fontWeight"),letterSpacing:h.getComputedStyle("letterSpacing"),lineHeight:h.getComputedStyle("lineHeight")});k.set("text",e);a.one("body").append(k);b=parseInt(k.getComputedStyle("height"));if(b<=g){k.remove();return;}for(var j;d>=1;){d=Math.floor(d/2);f+=b>g?-d:+d;k.set("text",e.slice(0,f-i.ellipsis.length)+i.ellipsis);b=parseInt(k.getComputedStyle("height"));if(b<=g){j=f;}}k.remove();if(!h.getAttribute("originalText")){h.setAttribute("originalText",e);}h.set("text",e.slice(0,j-i.ellipsis.length-i.fudge)+i.ellipsis);return h;};a.Node.importMethod(a.DOM,"ellipsis");a.NodeList.importMethod(a.Node.prototype,"ellipsis");},"0.0.1",{requires:["base","node"]});
