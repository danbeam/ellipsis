YUI().add("ellipsis",function(a){a.DOM.ellipsis=function(c,i){i=i||{};a.mix(i,{ellipsis:" ...",fudge:0,lines:1});console.log(i);console.log(a.one(c).getComputedStyle("lineHeight"));console.log(a.one(c).getComputedStyle("fontSize"));var h=a.one(c),g=i.lines*(parseInt(h.getComputedStyle("lineHeight"))||(parseInt(h.getComputedStyle("fontSize"))+3)),e=h.getAttribute("originalText")||h.get("text"),f=e.length,d=f,k=a.one(document.createElement(h.get("nodeName"))),b;k.setStyles({position:"absolute",visibility:"hidden",bottom:"-10px",right:"-10px",width:h.getComputedStyle("width"),fontSize:h.getComputedStyle("fontSize"),fontFamily:h.getComputedStyle("fontFamily"),fontWeight:h.getComputedStyle("fontWeight"),letterSpacing:h.getComputedStyle("letterSpacing"),lineHeight:h.getComputedStyle("lineHeight")});k.set("text",e);a.one("body").append(k);b=parseInt(k.getComputedStyle("height"));console.log("currentHeight",b);console.log("targetHeight",g);if(b<=g){console.log("truncation not necessary!");k.remove();return;}for(var j;d>=1;){d=Math.floor(d/2);f+=b>g?-d:+d;k.set("text",e.slice(0,f-i.ellipsis.length)+i.ellipsis);b=parseInt(k.getComputedStyle("height"));if(b<=g){j=f;}console.log("currentLength",f);console.log("currentHeight",b);console.log("targetHeight",g);console.log("charIncrement",d);console.log("lastKnownGood",j);}k.remove();if(!h.getAttribute("originalText")){h.setAttribute("originalText",e);}h.set("text",e.slice(0,j-i.ellipsis.length-i.fudge)+i.ellipsis);return h;};a.Node.importMethod(a.DOM,"ellipsis");a.NodeList.importMethod(a.Node.prototype,"ellipsis");},"0.0.1",{requires:["base","node"]});